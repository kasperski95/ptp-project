<!DOCTYPE html>
<html style="width: 100%; height: 100%; padding: 0; overflow: hidden;">
  <head>
  </head>
  <body style="width: 100%; height: 100%; padding: 0; padding-bottom: 1em; box-sizing: border-box; margin: 0; font-family: 'Arial'; font-weight: bold; overflow: hidden;">
    <div style="height: 3em; font-size: 2em; display: flex; align-items:center; justify-content: center; box-sizing: border-box; color: rgba(255, 40, 70, 1); overflow: hidden;" id="result"></div>
    <div style="height: calc(100% - 6em); overflow: hidden;">
      <canvas id="myCanvas" style="width: 100%; height: 100%; padding: 0; margin: 0;"></canvas>
    </div>
  </body>



  <script>
    const electron = require('electron.js');
    const Chart = require('chart.js');

    var result = document.getElementById('result');    

    var ctx = document.getElementById('myCanvas').getContext('2d');    
    var myChart = new Chart(ctx, {
        type: 'scatter',
        data: {
          datasets: [{
            borderColor: ['rgba(255, 40, 70, 1)'],
            borderWidth: 5,
            showLine: true
          }]
        },
        options: {
          scales: {
            xAxes: [{
              gridLines: {
                  display: false
                } ,
              ticks: {
                display: false,
                
              }
            }],
            yAxes: [{
              ticks: {
                min: 0,
                max: 30
              }
            }]
          },
          legend: {
            display: false
          },
          animation: {
              duration: 0 // general animation time
          },
          hover: {
              animationDuration: 0 // duration of animations when hovering an item
          },
          responsiveAnimationDuration: 0, // animation duration after a resize
          elements: {
            point:{
              radius: 0
            }
          },
          maintainAspectRatio: false
        }
    });




    electron.ipcRenderer.on('update', (e, arg) => {
      myChart.data.datasets.forEach((dataset) => {
        dataset.data = arg.data;
      });
      myChart.options.scales.xAxes[0].ticks.min = Date.now() - arg.startTime - arg.config.chartSpanInMs;
      myChart.options.scales.xAxes[0].ticks.max = Date.now() - arg.startTime - arg.config.samplesPerSecond / arg.config.packSize *  arg.config.samplesAhead;
      result.innerHTML = `${arg.data[arg.data.length - 1].y.toFixed(1)} cm`;
      myChart.update();
    })

    electron.ipcRenderer.on('log', (e, arg) => {
      console.log(arg);
    })
  </script>
</html>